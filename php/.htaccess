RewriteEngine On

# Si le fichier ou dossier existe, on ne touche pas
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}.php -f

# Réécriture
RewriteRule ^(.+)$ $1.php [L]

# Sécurité : bloquer les méthodes HTTP non désirées
<LimitExcept GET POST>
    Require all denied
</LimitExcept>

# Sécurité : bloquer l'accès aux fichiers cachés (commençant par un point)
<FilesMatch "^\.">
    Require all denied
</FilesMatch>

# Sécurité : désactiver l'indexation des répertoires
Options -Indexes

# Sécurité : en-têtes HTTP de sécurité
Header always set X-Content-Type-Options "nosniff"
Header always set X-Frame-Options "SAMEORIGIN"
Header always set X-XSS-Protection "1; mode=block"
Header always set Referrer-Policy "no-referrer-when-downgrade"
Header always set Content-Security-Policy "default-src 'self'; script-src 'self';
    style-src 'self' 'unsafe-inline'; img-src 'self' data:; font-src 'self'; connect-src 'self'; frame-ancestors 'self'; form-action 'self'; base-uri 'self';"
